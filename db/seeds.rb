class Seed

  WES_SCHEDULE = [
    # to Wilsonville
    '05:58', '06:03', '06:09', '06:15', '06:25',
    '06:28', '06:33', '06:39', '06:45', '06:55',
    '06:58', '07:03', '07:09', '07:15', '07:25',
    '07:28', '07:33', '07:39', '07:45', '07:55',
    '07:58', '08:03', '08:09', '08:15', '08:25',
    '08:28', '08:33', '08:39', '08:45', '08:55',
    '08:58', '09:03', '09:09', '09:15', '09:25',
    '09:28', '09:33', '09:39', '09:45', '09:55',

    '16:05', '16:10', '16:16', '16:22', '16:32',
    '16:35', '16:40', '16:46', '16:52', '17:02',
    '17:05', '17:10', '17:16', '17:22', '17:32',
    '17:35', '17:40', '17:46', '17:52', '18:02',
    '18:05', '18:10', '18:16', '18:22', '18:32',
    '18:35', '18:40', '18:46', '18:52', '19:02',
    '19:05', '19:10', '19:16', '19:22', '19:32',
    '19:35', '19:40', '19:46', '19:52', '20:02',


    # to Beaverton TC
    '05:21', '05:31', '05:39', '05:43', '05:48',
    '05:51', '06:01', '06:09', '06:13', '06:18',
    '06:21', '06:31', '06:39', '06:43', '06:48',
    '06:51', '07:01', '07:09', '07:13', '07:18',
    '07:21', '07:31', '07:39', '07:43', '07:48',
    '07:51', '08:01', '08:09', '08:13', '08:18',
    '08:21', '08:31', '08:39', '08:43', '08:48',
    '08:51', '09:01', '09:09', '09:13', '09:18',

    '15:28', '15:38', '15:46', '15:50', '15:55',
    '15:58', '16:08', '16:16', '16:20', '16:25',
    '16:28', '16:38', '16:46', '16:50', '16:55',
    '16:58', '17:08', '17:16', '17:20', '17:25',
    '17:28', '17:38', '17:46', '17:50', '17:55',
    '17:58', '18:08', '18:16', '18:20', '18:25',
    '18:28', '18:38', '18:46', '18:50', '18:55',
    '18:58', '19:08', '19:16', '19:20', '19:25'
  ]

  WEEKDAY_BLUE_SCHEDULE = [
    '05:43:00',
    '05:41:00',
    '05:44:30',
    '05:45:30',
    '05:48:00',
    '05:50:00',
    '05:51:30',
    '05:53:30',
    '05:55:30',
    '05:57:30',
    '06:00:00',
    '06:03:00',
    '06:06:30',
    '06:08:30',
    '06:10:30',
    '06:13:30',
    '06:17:30',
    '06:19:00',
    '06:20:30',
    '06:21:30',
    '06:25:00',
    '06:26:00',
    '06:27:00',
    '06:28:30',
    '06:30:00',
    '06:32:00',
    '06:33:00',
    '06:35:30',
    '06:37:30',
    '06:39:30',
    '06:43:00',
    '06:48:30',
    '06:53:30',
    '06:55:30',
    '06:57:30',
    '06:59:30',
    '07:00:30',
    '07:02:30',
    '07:05:00',
    '07:07:00',
    '07:09:00',
    '07:11:00',
    '07:14:00',
    '07:17:00',
    '07:19:00',
    '07:21:00',
    '07:23:00'
  ]

  WEEKDAY_BLUE_SCHEDULE_2 = [
    '09:39:30',
    '09:41:30',
    '09:43:00',
    '09:44:00',
    '09:46:30',
    '09:48:30',
    '09:50:00',
    '09:52:00',
    '09:54:00',
    '09:56:00',
    '09:58:30',
    '10:01:30',
    '10:05:00',
    '10:07:00',
    '10:09:00',
    '10:12:00',
    '10:16:00',
    '10:17:30',
    '10:19:00',
    '10:20:00',
    '10:23:30',
    '10:24:30',
    '10:25:30',
    '10:27:00',
    '10:28:30',
    '10:30:30',
    '10:31:30',
    '10:34:00',
    '10:36:00',
    '10:38:00',
    '10:41:30',
    '10:47:00',
    '10:52:00',
    '10:54:00',
    '10:56:00',
    '10:58:00',
    '10:59:00',
    '11:01:00',
    '11:03:30',
    '11:05:30',
    '11:07:30',
    '11:09:30',
    '11:12:30',
    '11:15:30',
    '11:17:30',
    '11:19:30',
    '11:21:30'
  ]

  BLUE_EASTBOUND_STOPS = [
    9848,
    9846,
    9843,
    9841,
    9838,
    9839,
    9835,
    9834,
    9831,
    9830,
    9828,
    9822,
    9826,
    9824,
    9821,
    9969,
    10120,
    10118,
    9759,
    9758,
    8333,
    8334,
    8335,
    8336,
    8337,
    8338,
    8339,
    8340,
    8341,
    8342,
    8343,
    8344,
    8345,
    8346,
    8347,
    8348,
    8349,
    8350,
    8351,
    8352,
    8353,
    8354,
    8355,
    13450,
    8356,
    8357,
    8359
  ]

  BLUE_WESTBOUND_STOPS = [
    # 8359,
    8360,
    8361,
    13449,
    8362,
    8363,
    8364,
    8365,
    8366,
    8367,
    8368,
    8369,
    8370,
    8371,
    8372,
    8373,
    8374,
    8375,
    8376,
    8377,
    8378,
    8379,
    8380,
    8381,
    8382,
    8383,
    8384,
    9757,
    9820,
    10117,
    10121,
    9624,
    9818,
    9823,
    9825,
    9819,
    9827,
    9829,
    9832,
    9833,
    9836,
    9840,
    9837,
    9842,
    9844,
    9845
    # 9848
  ]

  RED_NORTHBOUND_STOPS = [
    { local_id: 10572, name: 'Parkrose/Sumner TC MAX Station'},
    { local_id: 10574, name: 'Cascades MAX Station'},
    { local_id: 10576, name: 'Mt Hood Ave MAX Station'},
    { local_id: 10579, name: 'Portland Int\'l Airport MAX Station'}
  ]

  RED_SOUTHBOUND_STOPS = [
    { local_id: 10577, name: 'Mt Hood Ave MAX Station'},
    { local_id: 10575, name: 'Cascades MAX Station'},
    { local_id: 10573, name: 'Parkrose/Sumner TC MAX Station'}
  ]

  def self.begin
    seed = Seed.new
    seed.generate_agencies
    seed.generate_routes(1)
    seed.generate_route_directions
    seed.generate_stops(1)
    seed.generate_trips
    seed.generate_stop_times
  end

  def generate_agencies
    Agency.create!(name: 'TriMet',
                   id:   1
                  )
  end

  def generate_routes(agency_id)
    Route.create!(agency_id:  agency_id.to_i,
                  local_id:   '203',
                  name:       'WES Commuter Rail',
                  short_name: 'WES',
                  id:         1
                 )
    Route.create!(agency_id: agency_id.to_i,
                  local_id:   '100',
                  name:       'MAX Blue Line',
                  short_name: 'Blue',
                  id:         2
                 )
    Route.create!(agency_id: agency_id.to_i,
                  local_id:   '90',
                  name:       'MAX Red Line',
                  short_name: 'Red',
                  id:         3
                )
  end

  def generate_route_directions
    RouteDirection.create!(route_id:        1,
                           direction_id:    0,
                           direction_name:  'To Wilsonville',
                           id:              1
                          )
    RouteDirection.create!(route_id:        1,
                           direction_id:    1,
                           direction_name:  'To Beaverton',
                           id:              2
                          )

    RouteDirection.create!(route_id:        2,
                           direction_id:    0,
                           direction_name:  'To Gresham',
                           id:              3
                          )
    RouteDirection.create!(route_id:        2,
                           direction_id:    1,
                           direction_name:  'To Hillsboro',
                           id:              4
                          )
    RouteDirection.create!(route_id:        3,
                           direction_id:    0,
                           direction_name:  'To Portland International Airport',
                           id:              5
                          )
    RouteDirection.create!(route_id:        2,
                           direction_id:    1,
                           direction_name:  'To Beaverton Transit Center',
                           id:              6
                          )

  end

  def generate_stops(agency_id)
    Stop.create!(agency_id:  agency_id.to_i,
                 local_id:   '13066',
                 name:       'Beaverton TC WES Station',
                 latitude:   45.49064,
                 longitude:  -122.801157,
                 id:         1
                )
    Stop.create!(agency_id:  agency_id.to_i,
                 local_id:   '13067',
                 name:       'Hall/Nimbus WES Station',
                 latitude:   45.457587,
                 longitude:  -122.786997,
                 id:         2
                )
    Stop.create!(agency_id:  agency_id.to_i,
                 local_id:   '130668',
                 name:       'Tigard TC WES Station',
                 latitude:   45.429936,
                 longitude:  -122.769527,
                 id:         3
                )
    Stop.create!(agency_id:  agency_id.to_i,
                 local_id:   '13069',
                 name:       'Tualatin WES Station',
                 latitude:   45.383621,
                 longitude:  -122.764504,
                 id:         4
                )
    Stop.create!(agency_id:  agency_id.to_i,
                 local_id:   '13070',
                 name:       'Wilsonville WES Station',
                 latitude:   45.311358,
                 longitude:  -122.775303,
                 id:         5
                )
    Stop.create!(agency_id:  agency_id.to_i,
                 local_id:   '13073',
                 name:       'Tigard TC WES Station',
                 latitude:   45.430229,
                 longitude:  -122.769834,
                 id:         6
                )


    BLUE_EASTBOUND_STOPS.each.with_index do |stop_id, index|
      Stop.create!(agency_id:  agency_id.to_i,
                   local_id:   stop_id.to_s,
                   id:         7 + index
                  )
    end

    BLUE_WESTBOUND_STOPS.each.with_index do |stop_id, index|
      Stop.create!(agency_id:   agency_id.to_i,
                   local_id:    stop_id.to_s,
                   id:          54 + index
                  )
    end


    RED_NORTHBOUND_STOPS.each.with_index do |stop, index|
      Stop.create!(agency_id:   agency_id.to_i,
                   local_id:    stop[:local_id].to_s,
                   name:        stop[:name],
                   id:          99 + index
                  )
    end

    RED_SOUTHBOUND_STOPS.each.with_index do |stop, index|
      Stop.create!(agency_id:   agency_id.to_i,
                   local_id:    stop[:local_id].to_s,
                   name:        stop[:name],
                   id:          103 + index
                  )
    end

  end

  def generate_trips
    16.times do
      Trip.create!(route_direction_id:  1)
    end # make 16 trips to Wilsonville
    16.times do
      Trip.create!(route_direction_id:  2)
    end # make 16 trips to Beaverton TC

    Trip.create!(route_direction_id: 4,
                 local_id:           '7604612'
                )
    Trip.create!(route_direction_id: 4,
                 local_id:           '7604638')
  end

  def generate_stop_times
    # to Wilsonville
    0.upto(15) do |num|
      0.upto(4) do |offset|
        StopTime.create!(stop_id:       offset+1,
                         trip_id:       num+1,
                         stop_sequence: offset+1,
                         arrival_time:  WES_SCHEDULE[num*5+offset] + ':00',
                         depart_time:   WES_SCHEDULE[num*5+offset] + ':00'
                        )
      end
    end

    # to Beaverton TC
    16.upto(31) do |num|
      0.upto(4) do |offset|
        stop_id = (offset+1 == 3 ? 6 : offset+1) # correct stop_id for Tigard TC, northbound platform
        StopTime.create!(stop_id:       stop_id,
                         trip_id:       num+1,
                         stop_sequence: offset+1,
                         arrival_time:  WES_SCHEDULE[num*5+offset] + ':00',
                         depart_time:   WES_SCHEDULE[num*5+offset] + ':00'
                        )
      end
    end

    # Blue to Hillsboro
    all_westbound_stops = [53, *(54..98).to_a, 7]
    WEEKDAY_BLUE_SCHEDULE.each.with_index do |stop_time, index|
      StopTime.create!(stop_id:       all_westbound_stops[index],
                       trip_id:       33,
                       stop_sequence: 1 + index,
                       arrival_time:  stop_time,
                       depart_time:   stop_time
                      )
    end
    WEEKDAY_BLUE_SCHEDULE_2.each.with_index do |stop_time, index|
      StopTime.create!(stop_id:       all_westbound_stops[index],
                       trip_id:       34,
                       stop_sequence: 1 + index,
                       arrival_time:  stop_time,
                       depart_time:   stop_time
                      )
    end
  end

end

Seed.begin
